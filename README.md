
============================================================
Sebastian Riveros Koenderink
Base de datos 2
Ingenieria Informatica
Umag
2025

Tarea 2 BD2 2025

============================================================
⠀⠀⠀⠀⠀ ⠀⣀⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀   ⠀⣀⡀⠀⠀⠀⠀⠀⠀
⠀⠀⣀⡴⠞⠉⢉⡿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢯⡉⠙⠳⣦⡀⠀⠀
⢀⣼⠋⠀⠀⢀⣤⠇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠻⣄⠀⠀⠈⠻⣆⠀
⣼⠃⠀⠀⣰⠏⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠳⣄⠀⠀⠹⡇
⡟⠀⠀⢰⡏⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣿⠀⠀ ⠀⣿
⣿⠀⠀⠘⣧⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⡿⠀⠀⢠⡿
⠘⣷⡀⠀⠘⢷⣄⣀⣀⣀⣀⣀⣀⣀⣀⣀⣀⣴⠟⠁⠀⣠⡾⠁
⠀⠈⠻⣦⠀⠀⠈⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠀⠀⣼⠋⠀⠀
⠀⠀⠀⢸⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀    ⢸⡇⠀⠀⠀
⠀⠀⠀⢸⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀    ⢸⡇⠀⠀
⠀⠀⠀⢸⡇⢠⣶⣿⣿⣦⡀⠀⠀⠀  ⡠⣦⣿⣷⣦⡀⢸⡇⠀⠀⠀
⠀⠀⠀⠸⡇⣿⣿⣿⣿⣿⣶⠀⠀⠀  ⣿⣿⣿⣿⣿⣶⢸⡇⠀⠀⠀
⠀⠀⠀⢰⣇⢻⣿⣿⣿⣿⡟⠀⠀⠀  ⢿⣿⣿⣿⣟⡟⣼⠃⠀⠀⠀
⠀⠀⠀⠀⣻⣆⠙⠛⠛⠋⠀⠀⠀⠀  ⠈⠙ ⠛⠛⢁⣴⠏⠀⠀⠀⠀
⠀⠀⠀⠀⠻⣿⡿⣶⣦⣤⣤⣀⣀⣀⣀⣤⣤⡶⠖⠋⠁⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠈⢻⡆⣱⣾⠟⠉⣽⢋⡟⣯⠻⣆⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠻⣿⠟⠁⣠⡾⠁⠜⢸⡉⠁⡽⡆⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⡏⣠⡾⠋⢀⠆⠀⣼⢷⡀⠸⣽⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⢰⡿⠉⣀⡴⠋⠀⣰⢿⠀⠻⣄⢹⡇⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⣸⣡⡾⠋⠀⣠⣷⣿⡈⢧⡀⠘⣾⡇⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⣿⠏⠄⢠⣾⣿⣿⣿⣿⣌⠳⣄⢹⡷⣄⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠹⣧⡷⠏⣿⣿⡏⠈⣿⣿⣿⣾⣿⠛⠻⠷⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠉⠀ ⠀⢹⣿⡇ ⠀⣿⡟⠈⠉⠋⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀  ⠉⠀     ⠉⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀


============================================================
Comentarios: 
============================================================
Para esta Tarea 2 quise seguir la misma tematica de juegos, como la de la tarea 1 
integrandolo en el initial_data.sql inspirado en League of legends, Halo, God of war, Red dead Redemption 2, Assassins creed, Super mario, Pokemon, Hollow Knight, Elden Ring y Zelda...  

"Los textos me los invente, desconozco si hay libros que se llamen asi, asi que cualquier parecido con la realidad es mera coincidencia"

============================================================
                 ESTRUCTURA DEL PROYECTO
============================================================

app/
 ├─ controllers/
 │   ├─ auth_controller.py
 │   ├─ book_controller.py
 │   ├─ category_controller.py
 │   ├─ loan_controller.py
 │   └─ review_controller.py
 ├─ dtos/
 ├─ repositories/
 ├─ models.py
 ├─ config.py
 ├─ db.py
 └─ security.py
migrations/
initial_data.sql
README.md

=============================================================
        INSTRUCCIONES DE INSTALACION Y EJECUCION
============================================================
1. Instalar dependencias

uv sync

2. Configurar entorno

cp .env.example .env

Editar .env con los valores de conexion a PostgreSQL (ejemplo):

DATABASE_URL=postgresql+psycopg://usuario:contraseña@localhost:5432/nombre_biblioteca  

3. Crear base de datos en PostgreSQL

createdb nombre_biblioteca

4. Aplicar migraciones 

uv run alembic upgrade head

5. Cargar datos iniciales

psql -U postgres -d nombre_biblioteca -f initial_data.sql

o en SQL Shell (psql) su equivalente

\c nombre_biblioteca        "debe aparecer un mensaje de ahora estas conectado a nombre_biblioteca "
   
   luego

\i 'C:/Users/srive/Desktop/learning-litestar-bd2-2025-main/initial_data.sql'            

"si sale todo bien debe aparecer: 
INSERT 0 5
INSERT 0 10
INSERT 0 10
INSERT 0 5
INSERT 0 8
INSERT 0 15
"


6. Ejecutar servidor

uv run litestar run

Luego abrir:

http://localhost:8000/schema

============================================================
TABLA DE CUMPLIMIENTO DE REQUERIMIENTOS
============================================================
Req	Descripcion	Estado	Observaciones
1	Modelo Category + m2m + DTOs + CRUD + migracion	Cumplido	/categories disponible en schema
2	Modelo Review + validaciones + CRUD + migracion	Cumplido	Rating 1-5 y maximo 3 reviews por usuario/libro
3	Actualizacion Book + validaciones + migracion	Cumplido	Stock positivo, language ISO 639-1 validado
4	Actualizacion User + validaciones email + DTOs + migracion	Cumplido	is_active no modificable por usuarios
5	Actualizacion Loan + enum + due_date + migracion	Cumplido	due_date = loan_dt + 14 dias
6	BookRepository con metodos adicionales + endpoints	Cumplido	includes search, top reviewed, update stock
7	LoanRepository con logica completa + endpoints	Cumplido	incluye devolucion, multas y overdue
8	initial_data.sql con 5 categorias, 10 libros, 5 usuarios, 8 prestamos y 15 reviews


============================================================
Tecnologias usadas
- Python 3.11
- Litestar 2.18
- SQLAlchemy
- Alembic
- PostgreSQL
- uv
=============================================================

============================================================
EJEMPLOS DE ENDPOINTS
============================================================
Obtener libros disponibles

GET /books/available

Buscar por categoria

GET /books/category/1

Crear review

POST /reviews

Marcar prestamos vencidos

GET /loans/overdue

Devolver libro

POST /loans/{id}/return

============================================================
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣀⡤⠶⢛⡿⠟⠉⣁⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣠⡾⠉⠀⣴⡿⢖⡿⠿⠛⠉⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣠⢶⡟⠀⠀⠸⡫⠞⠛⠚⠉⠉⠙⠓⠲⢦⣄⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡴⡏⡿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣾⠏⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣇⢧⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣀⡴⠋⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢻⡈⠳⡀⠀⠀⠀⠀⠀⠀⠀⣀⣴⠞⢋⣠⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡴⠋⢹
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣀⣀⣤⣤⣤⣬⣧⣀⡀⠀⠀⠠⠤⠖⠒⠛⠛⠒⣺⠟⠁⠀⠀⠀⠀⠀⣀⠀⠀⠀⠀⠀⠀⣸⠃⠀⣸
⢰⡷⢶⣦⣄⣀⠀⠀⠀⣠⣴⠾⠛⠉⠉⠀⠀⠀⠀⠈⠉⠛⠿⣶⣄⠀⠰⣦⣶⣶⡋⢁⣴⢷⠶⢄⡀⠀⠀⠸⣿⣲⠏⠳⠦⣴⡏⠀⠀⡟
⢸⡇⣷⡦⣈⠙⢓⣶⠟⠋⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠙⠿⣦⡹⡟⠦⠀⣽⠳⣄⠓⠤⣽⢤⣄⣰⠃⠉⠓⠦⣞⡿⠁⠀⢠⡇
⠸⡇⡇⠁⠈⢱⣾⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⢿⣷⡀⠀⡏⠀⠈⠓⠾⣧⠞⠉⠙⠳⢦⣄⡴⢺⠇⠀⠀⣼⠀
⠀⣷⢳⠀⣰⢋⣭⣙⣓⠶⢦⣄⣀⠀⠀⠀⢀⣀⣀⣀⣤⠤⠤⠤⠤⠤⣤⡀⠹⣧⢰⡇⠀⠀⠀⣼⠋⠀⠀⠀⠀⠀⠈⣹⣿⠀⠀⢰⠇⠀
⠀⠸⣟⣴⢯⢎⠏⢰⠏⢀⠏⢠⡿⠁⠀⣟⢹⢉⡤⣤⣄⣒⣒⣒⣒⣲⡆⢻⠀⠹⣿⠃⠀⠀⡼⠃⠀⠀⠀⠀⠀⣠⡞⢡⡇⠀⢀⡟⠀⠀
⠀⠀⢻⣿⡟⡞⢀⠎⠀⡞⢀⣞⣀⡀⠀⢹⠘⡄⣏⠉⠉⠀⠀⠀⠀⠘⣾⠘⣇⣀⣿⠀⠀⣼⠃⠀⠀⠀⠀⢀⡾⠋⠀⣼⠀⢀⣾⠁⠀⠀
⠀⠀⡟⢸⣸⠀⡞⢀⠞⢀⡟⠀⠀⠉⠉⢹⡄⡇⢸⠀⠀⠀⠀⠀⠀⠀⢧⡆⣇⠀⢸⠀⡼⠁⠀⠀⠀⠀⣴⠟⢬⡙⢲⡇⠀⡾⠃⠀⠀⠀
⠀⠸⣧⣤⣈⣉⣁⡞⠀⡾⠉⠓⠒⠒⠒⠺⡇⢸⠈⠧⠒⠒⠒⠈⢉⣉⣉⣁⡟⠉⢹⣴⠃⠀⠀⠀⢠⡾⠃⠀⠀⠙⡾⠀⣼⠃⠀⠀⠀⠀
⠀⣴⠞⠁⠀⠉⠉⠙⠛⠁⠀⠀⠀⠀⠀⠀⠻⠞⠓⠒⠚⠛⠛⠉⠉⠉⠉⠉⣀⣠⣴⠟⠁⠀⠀⢠⡟⠀⠀⠀⠀⣰⠇⣰⠃⠀⠀⠀⠀⠀
⠀⠈⠉⠛⢶⠶⣶⡶⣤⣤⣀⣀⣀⣀⣀⣀⣠⣀⣀⣀⣀⣤⠤⠶⠶⡶⠚⠋⠉⠳⣞⣀⡀⠀⣰⠏⠀⠀⠀⠀⣠⡟⢠⡇⠀⠀⠀⠀⠀⠀
⠀⠀⠠⣴⣻⣰⠋⠳⣄⠘⡆⠀⠀⠀⢸⠁⣠⠞⠉⠉⠙⠲⢄⠀⠀⣱⠀⠀⠀⢉⣩⣷⣶⣿⠏⠀⠀⠀⣠⢾⣏⣀⣸⡇⠀⠀⠀⠀⠀⠀
⢐⣶⡶⠍⠀⠑⢄⠀⠈⢦⠇⠀⠀⠀⢸⠚⠁⠀⠀⠀⠀⠀⠀⣁⠔⠁⠀⠀⣀⣤⣶⣏⣡⠏⠀⢀⣰⠞⠃⢸⠀⢉⡿⠁⠀⠀⠀⠀⠀⠀
⠀⠻⢿⡦⠄⠀⠀⠉⠲⣺⠋⠙⠒⠦⣌⠳⠦⠤⠴⠶⠖⠚⠉⠀⠀⠀⠀⣠⣞⡉⠀⠈⠉⠉⢳⠞⢉⢦⡄⡾⠀⣾⠁⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠙⢷⣄⠀⠀⠀⠙⠒⠤⢤⠴⠊⠀⣀⠴⠂⠀⠀⠀⠀⠀⠀⣠⡾⣿⣿⣶⣤⢀⣀⣤⢿⣉⣵⠞⣹⠃⢸⠇⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⣙⣶⣤⣀⠈⠑⠒⠒⠶⠒⠊⠁⠀⠀⠀⠀⠀⢀⣠⠾⠋⠀⠰⣭⣟⣧⡸⢯⡉⠻⣍⠀⣰⡏⠀⡿⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⢀⣤⢾⡿⡉⠀⠉⢙⠳⠶⠶⢶⣤⣤⣤⣤⠤⠶⠶⠞⠋⠁⠀⢀⠀⣿⣮⣳⡈⢻⠀⠷⢦⣼⣶⣿⠀⢠⣧⣀⡀⠀⠀⠀⠀⠀⠀⠀
⠀⢰⠏⠀⣸⣺⠁⢀⣴⣏⡆⠀⠀⢒⡿⠀⠀⠀⠀⠀⠀⠀⠀⠀⡀⢸⣄⡿⡇⠉⠁⣸⠀⠀⣸⡏⠀⠈⣟⠋⠀⣉⡇⠀⠀⠀⠀⠀⠀⠀
⠀⣿⠀⠀⠁⢧⡶⠉⢸⡼⣇⣆⠠⡘⢧⡀⠀⡀⠀⡀⠀⢀⠆⢠⣧⡟⠟⠁⠁⢀⣴⠃⠀⢠⠟⠁⠀⣰⡇⠀⢐⠟⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠈⠳⣤⣠⡟⠀⠀⠈⠁⠹⠟⣄⣏⡆⢳⣄⢘⣄⣸⣤⣾⣾⠉⣫⣶⡿⢿⣷⣋⡀⠀⠰⡻⢶⠶⣞⣁⡠⠄⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⢰⡞⠉⢻⣆⠀⠀⠀⠀⠀⠀⠈⠛⣫⣟⣼⣯⠾⠛⠛⠉⢹⡋⠉⠀⠀⠀⠀⠹⣯⣻⠾⠒⢺⡗⢦⣤⠤⠞⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠈⠳⣄⡀⢹⡶⢦⣄⣀⠀⠀⠀⢀⡽⠳⡄⠈⢣⡀⠀⠀⠈⣷⣄⣠⢤⣔⣦⠴⠟⠁⠀⠀⣼⢡⡞⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠈⠉⢻⢿⡷⢶⣮⢍⣉⣛⡟⠀⠀⠙⣆⠀⢧⡀⠀⠀⢘⡶⠛⣏⣵⠀⠀⠀⠀⢀⡼⠃⣾⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠸⣌⠓⠤⣌⣉⣉⣲⣷⡀⠀⠀⢹⢂⢸⣘⡾⠛⠉⣠⠞⠁⡇⠀⠀⠀⠀⡿⠤⣄⡟⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠙⣦⠀⠀⠉⣩⠟⠁⠙⠓⠒⢞⣟⣼⠛⣊⡤⠞⠁⠀⢸⠃⠀⠀⠀⠀⡇⠀⣸⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⣰⠋⢁⡀⢰⠃⠀⠀⠀⠀⠀⠈⠉⠉⠫⡁⠀⠀⠀⠀⡾⠀⠀⠀⠀⢀⡇⢰⡏⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⢠⣾⠥⠒⠋⠉⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⢳⡀⠀⢰⡇⠀⠀⠀⠀⡼⠀⣿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠈⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠹⡄⠀⠙⢦⡀⠀⡼⠁⠀⡏⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠛⠲⠶⠶⠿⢾⠃⠀⠀⣿⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⣄⣀⣴⠏⠀⠀
